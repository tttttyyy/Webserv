server {
    listen      <port>;
    server_name <server_name>;

    # Default server for this host:port
    default_server;

    # Setup default error pages
    error_page 404 /error404.html;
    error_page 500 502 503 504 /error50x.html;

    # Limit client body size
    client_max_body_size 10M;

    # Define routes and configurations
    location / {
        # Define accepted HTTP methods for the route
        limit_except GET POST {
            deny all;
        }

        # Define a HTTP redirection
        if ($query_string) {
            rewrite ^/(.*)$ /redirected?$query_string redirect;
        }

        # Define a directory or a file from where the file should be searched
        try_files $uri $uri/ /index.html;

        # Turn on or off directory listing
        autoindex on;
    }

    location /kapouet {
        # Set a default file to answer if the request is a directory
        index default.html;

        # Execute CGI based on certain file extension (e.g., .php)
        location ~ \.php$ {
            fastcgi_pass   unix:/var/run/php/php7.4-fpm.sock;
            fastcgi_index  index.php;
            include        fastcgi_params;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
        }

        # Make it work with POST and GET methods
        limit_except GET POST {
            deny all;
        }

        # Make the route able to accept uploaded files and configure where they should be saved
        client_body_temp_path /tmp/uploads;
        client_body_in_file_only on;
        client_body_buffer_size 128K;
        client_max_body_size 10M;

        # CGI configuration
        include cgi_params;
    }
}